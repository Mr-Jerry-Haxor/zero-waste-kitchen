import{a as li,b as pi,c as mi,d as di}from"./chunk-KQIXHO63.js";import{a as at,b as Si,c as st,d as ct,e as Ie}from"./chunk-3ERMOSCR.js";import{a as yi,b as Mi,c as Pe,d as de}from"./chunk-EAFGYPA3.js";import{e as si,i as ci,j as tt}from"./chunk-TU25NA76.js";import{a as xi,b as ot}from"./chunk-IIB3MZ2O.js";import{a as Ci,b as bi}from"./chunk-53YMNWMP.js";import{a as ae,b as se,c as ce,d as le,e as et,f as pe,g as $,h as ui,i as fi,j as gi,l as hi,m as vi,n as _i,o as it,p as rt,q as wi,r as nt}from"./chunk-JWQ7PSM2.js";import{a as Jt,d as ri,f as ni,g as oi,j as ai,l as me,m as G}from"./chunk-LRXY6OD2.js";import{Ba as Zt,Fa as Qt,Ja as Xt,La as ei,Pa as ti,Qa as ii,Sa as Qe,Ta as Xe,Y as Ze,a as $t,aa as ne,ba as W,h as Gt,j as Je,k as Ht,p as Ue,q as Yt,ya as oe,za as Kt}from"./chunk-FXEP3DK6.js";import{$ as He,$a as be,$b as l,Ab as Ut,Bb as Vt,F as Ce,Ib as a,Jb as o,Kb as T,Mc as Oe,Nc as re,Ob as ie,Qb as L,Qc as Ye,Rb as S,Rc as Wt,Sc as Ke,Tc as q,_b as Se,a as j,aa as Nt,ac as N,b as Y,bb as u,bc as B,c as Ft,cc as zt,d as jt,e as b,ea as wt,ec as K,f as wr,fc as J,g as w,gb as D,gc as Z,ic as qt,jc as Q,kc as Be,lc as Re,n as _t,na as x,nb as te,oa as C,ob as Bt,s as xe,sb as O,zb as h}from"./chunk-56SOJHVL.js";var Pi=b((co,Pt)=>{"use strict";var Ot=function(t){"use strict";var i=Object.prototype,e=i.hasOwnProperty,r=Object.defineProperty||function(c,s,n){c[s]=n.value},m,f=typeof Symbol=="function"?Symbol:{},v=f.iterator||"@@iterator",A=f.asyncIterator||"@@asyncIterator",R=f.toStringTag||"@@toStringTag";function E(c,s,n){return Object.defineProperty(c,s,{value:n,enumerable:!0,configurable:!0,writable:!0}),c[s]}try{E({},"")}catch{E=function(s,n,p){return s[n]=p}}function _e(c,s,n,p){var d=s&&s.prototype instanceof ge?s:ge,g=Object.create(d.prototype),_=new Ae(p||[]);return r(g,"_invoke",{value:$e(c,n,_)}),g}t.wrap=_e;function M(c,s,n){try{return{type:"normal",arg:c.call(s,n)}}catch(p){return{type:"throw",arg:p}}}var F="suspendedStart",fe="suspendedYield",X="executing",z="completed",k={};function ge(){}function V(){}function P(){}var De={};E(De,v,function(){return this});var Te=Object.getPrototypeOf,we=Te&&Te(Te(Fe([])));we&&we!==i&&e.call(we,v)&&(De=we);var ee=P.prototype=ge.prototype=Object.create(De);V.prototype=P,r(ee,"constructor",{value:P,configurable:!0}),r(P,"constructor",{value:V,configurable:!0}),V.displayName=E(P,R,"GeneratorFunction");function We(c){["next","throw","return"].forEach(function(s){E(c,s,function(n){return this._invoke(s,n)})})}t.isGeneratorFunction=function(c){var s=typeof c=="function"&&c.constructor;return s?s===V||(s.displayName||s.name)==="GeneratorFunction":!1},t.mark=function(c){return Object.setPrototypeOf?Object.setPrototypeOf(c,P):(c.__proto__=P,E(c,R,"GeneratorFunction")),c.prototype=Object.create(ee),c},t.awrap=function(c){return{__await:c}};function ye(c,s){function n(g,_,y,U){var I=M(c[g],c,_);if(I.type==="throw")U(I.arg);else{var je=I.arg,Ne=je.value;return Ne&&typeof Ne=="object"&&e.call(Ne,"__await")?s.resolve(Ne.__await).then(function(he){n("next",he,y,U)},function(he){n("throw",he,y,U)}):s.resolve(Ne).then(function(he){je.value=he,y(je)},function(he){return n("throw",he,y,U)})}}var p;function d(g,_){function y(){return new s(function(U,I){n(g,_,U,I)})}return p=p?p.then(y,y):y()}r(this,"_invoke",{value:d})}We(ye.prototype),E(ye.prototype,A,function(){return this}),t.AsyncIterator=ye,t.async=function(c,s,n,p,d){d===void 0&&(d=Promise);var g=new ye(_e(c,s,n,p),d);return t.isGeneratorFunction(s)?g:g.next().then(function(_){return _.done?_.value:g.next()})};function $e(c,s,n){var p=F;return function(g,_){if(p===X)throw new Error("Generator is already running");if(p===z){if(g==="throw")throw _;return Ge()}for(n.method=g,n.arg=_;;){var y=n.delegate;if(y){var U=Me(y,n);if(U){if(U===k)continue;return U}}if(n.method==="next")n.sent=n._sent=n.arg;else if(n.method==="throw"){if(p===F)throw p=z,n.arg;n.dispatchException(n.arg)}else n.method==="return"&&n.abrupt("return",n.arg);p=X;var I=M(c,s,n);if(I.type==="normal"){if(p=n.done?z:fe,I.arg===k)continue;return{value:I.arg,done:n.done}}else I.type==="throw"&&(p=z,n.method="throw",n.arg=I.arg)}}}function Me(c,s){var n=s.method,p=c.iterator[n];if(p===m)return s.delegate=null,n==="throw"&&c.iterator.return&&(s.method="return",s.arg=m,Me(c,s),s.method==="throw")||n!=="return"&&(s.method="throw",s.arg=new TypeError("The iterator does not provide a '"+n+"' method")),k;var d=M(p,c.iterator,s.arg);if(d.type==="throw")return s.method="throw",s.arg=d.arg,s.delegate=null,k;var g=d.arg;if(!g)return s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,k;if(g.done)s[c.resultName]=g.value,s.next=c.nextLoc,s.method!=="return"&&(s.method="next",s.arg=m);else return g;return s.delegate=null,k}We(ee),E(ee,R,"Generator"),E(ee,v,function(){return this}),E(ee,"toString",function(){return"[object Generator]"});function vt(c){var s={tryLoc:c[0]};1 in c&&(s.catchLoc=c[1]),2 in c&&(s.finallyLoc=c[2],s.afterLoc=c[3]),this.tryEntries.push(s)}function Le(c){var s=c.completion||{};s.type="normal",delete s.arg,c.completion=s}function Ae(c){this.tryEntries=[{tryLoc:"root"}],c.forEach(vt,this),this.reset(!0)}t.keys=function(c){var s=Object(c),n=[];for(var p in s)n.push(p);return n.reverse(),function d(){for(;n.length;){var g=n.pop();if(g in s)return d.value=g,d.done=!1,d}return d.done=!0,d}};function Fe(c){if(c){var s=c[v];if(s)return s.call(c);if(typeof c.next=="function")return c;if(!isNaN(c.length)){var n=-1,p=function d(){for(;++n<c.length;)if(e.call(c,n))return d.value=c[n],d.done=!1,d;return d.value=m,d.done=!0,d};return p.next=p}}return{next:Ge}}t.values=Fe;function Ge(){return{value:m,done:!0}}return Ae.prototype={constructor:Ae,reset:function(c){if(this.prev=0,this.next=0,this.sent=this._sent=m,this.done=!1,this.delegate=null,this.method="next",this.arg=m,this.tryEntries.forEach(Le),!c)for(var s in this)s.charAt(0)==="t"&&e.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=m)},stop:function(){this.done=!0;var c=this.tryEntries[0],s=c.completion;if(s.type==="throw")throw s.arg;return this.rval},dispatchException:function(c){if(this.done)throw c;var s=this;function n(U,I){return g.type="throw",g.arg=c,s.next=U,I&&(s.method="next",s.arg=m),!!I}for(var p=this.tryEntries.length-1;p>=0;--p){var d=this.tryEntries[p],g=d.completion;if(d.tryLoc==="root")return n("end");if(d.tryLoc<=this.prev){var _=e.call(d,"catchLoc"),y=e.call(d,"finallyLoc");if(_&&y){if(this.prev<d.catchLoc)return n(d.catchLoc,!0);if(this.prev<d.finallyLoc)return n(d.finallyLoc)}else if(_){if(this.prev<d.catchLoc)return n(d.catchLoc,!0)}else if(y){if(this.prev<d.finallyLoc)return n(d.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(c,s){for(var n=this.tryEntries.length-1;n>=0;--n){var p=this.tryEntries[n];if(p.tryLoc<=this.prev&&e.call(p,"finallyLoc")&&this.prev<p.finallyLoc){var d=p;break}}d&&(c==="break"||c==="continue")&&d.tryLoc<=s&&s<=d.finallyLoc&&(d=null);var g=d?d.completion:{};return g.type=c,g.arg=s,d?(this.method="next",this.next=d.finallyLoc,k):this.complete(g)},complete:function(c,s){if(c.type==="throw")throw c.arg;return c.type==="break"||c.type==="continue"?this.next=c.arg:c.type==="return"?(this.rval=this.arg=c.arg,this.method="return",this.next="end"):c.type==="normal"&&s&&(this.next=s),k},finish:function(c){for(var s=this.tryEntries.length-1;s>=0;--s){var n=this.tryEntries[s];if(n.finallyLoc===c)return this.complete(n.completion,n.afterLoc),Le(n),k}},catch:function(c){for(var s=this.tryEntries.length-1;s>=0;--s){var n=this.tryEntries[s];if(n.tryLoc===c){var p=n.completion;if(p.type==="throw"){var d=p.arg;Le(n)}return d}}throw new Error("illegal catch attempt")},delegateYield:function(c,s,n){return this.delegate={iterator:Fe(c),resultName:s,nextLoc:n},this.method==="next"&&(this.arg=m),k}},t}(typeof Pt=="object"?Pt.exports:{});try{regeneratorRuntime=Ot}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=Ot:Function("r","regeneratorRuntime = r")(Ot)}});var mt=b((lo,Ii)=>{"use strict";Ii.exports=(t,i)=>`${t}-${i}-${Math.random().toString(16).slice(3,8)}`});var It=b((po,ki)=>{"use strict";var Lr=mt(),Ei=0;ki.exports=({id:t,action:i,payload:e={}})=>{let r=t;return typeof r>"u"&&(r=Lr("Job",Ei),Ei+=1),{id:r,action:i,payload:e}}});var dt=b(Ve=>{"use strict";var Et=!1;Ve.logging=Et;Ve.setLogging=t=>{Et=t};Ve.log=(...t)=>Et?console.log.apply(Ve,t):null});var Li=b((ke,Ti)=>{"use strict";var Ar=It(),{log:ut}=dt(),Fr=mt(),Di=0;Ti.exports=()=>{let t=Fr("Scheduler",Di),i={},e={},r=[];Di+=1;let m=()=>r.length,f=()=>Object.keys(i).length,v=()=>{if(r.length!==0){let M=Object.keys(i);for(let F=0;F<M.length;F+=1)if(typeof e[M[F]]>"u"){r[0](i[M[F]]);break}}},A=(M,F)=>new Promise((fe,X)=>{let z=Ar({action:M,payload:F});r.push(k=>w(ke,null,function*(){r.shift(),e[k.id]=z;try{fe(yield k[M].apply(ke,[...F,z.id]))}catch(ge){X(ge)}finally{delete e[k.id],v()}})),ut(`[${t}]: Add ${z.id} to JobQueue`),ut(`[${t}]: JobQueue length=${r.length}`),v()});return{addWorker:M=>(i[M.id]=M,ut(`[${t}]: Add ${M.id}`),ut(`[${t}]: Number of workers=${f()}`),v(),M.id),addJob:(M,...F)=>w(ke,null,function*(){if(f()===0)throw Error(`[${t}]: You need to have at least one worker before adding jobs`);return A(M,F)}),terminate:()=>w(ke,null,function*(){Object.keys(i).forEach(M=>w(ke,null,function*(){yield i[M].terminate()})),r=[]}),getQueueLen:m,getNumWorkers:f}}});var Fi=b((fo,Ai)=>{"use strict";Ai.exports=t=>{let i={};return typeof WorkerGlobalScope<"u"?i.type="webworker":typeof document=="object"?i.type="browser":typeof process=="object"&&typeof Ft=="function"&&(i.type="node"),typeof t>"u"?i:i[t]}});var Ni=b((ho,ji)=>{"use strict";var jr=Fi()("type")==="browser",Nr=jr?t=>new URL(t,window.location.href).href:t=>t;ji.exports=t=>{let i=j({},t);return["corePath","workerPath","langPath"].forEach(e=>{t[e]&&(i[e]=Nr(i[e]))}),i}});var kt=b((_o,Bi)=>{"use strict";Bi.exports={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}});var Ui=b((wo,Br)=>{Br.exports={name:"tesseract.js",version:"6.0.0",description:"Pure Javascript Multilingual OCR",main:"src/index.js",types:"src/index.d.ts",unpkg:"dist/tesseract.min.js",jsdelivr:"dist/tesseract.min.js",scripts:{start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:* test:node:all","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser-tpl":"mocha-headless-chrome -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:detect":"npm run test:browser-tpl -- -f ./tests/detect.test.html","test:browser:recognize":"npm run test:browser-tpl -- -f ./tests/recognize.test.html","test:browser:scheduler":"npm run test:browser-tpl -- -f ./tests/scheduler.test.html","test:browser:FS":"npm run test:browser-tpl -- -f ./tests/FS.test.html",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},browser:{"./src/worker/node/index.js":"./src/worker/browser/index.js"},author:"",contributors:["jeromewu"],license:"Apache-2.0",devDependencies:{"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","mocha-headless-chrome":"^4.0.0","npm-run-all":"^4.1.5",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},dependencies:{"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^6.0.0","wasm-feature-detect":"^1.2.11",zlibjs:"^0.3.1"},overrides:{"@rollup/pluginutils":"^5.0.2"},repository:{type:"git",url:"https://github.com/naptha/tesseract.js.git"},bugs:{url:"https://github.com/naptha/tesseract.js/issues"},homepage:"https://github.com/naptha/tesseract.js",collective:{type:"opencollective",url:"https://opencollective.com/tesseractjs"}}});var zi=b((yo,Vi)=>{"use strict";Vi.exports={workerBlobURL:!0,logger:()=>{}}});var Wi=b((Mo,qi)=>{"use strict";var Ur=Ui().version,Vr=zi();qi.exports=Y(j({},Vr),{workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${Ur}/dist/worker.min.js`})});var Gi=b((Co,$i)=>{"use strict";$i.exports=({workerPath:t,workerBlobURL:i})=>{let e;if(Blob&&URL&&i){let r=new Blob([`importScripts("${t}");`],{type:"application/javascript"});e=new Worker(URL.createObjectURL(r))}else e=new Worker(t);return e}});var Yi=b((bo,Hi)=>{"use strict";Hi.exports=t=>{t.terminate()}});var Ji=b((So,Ki)=>{"use strict";Ki.exports=(t,i)=>{t.onmessage=({data:e})=>{i(e)}}});var Xi=b((Zi,Qi)=>{"use strict";Qi.exports=(t,i)=>w(Zi,null,function*(){t.postMessage(i)})});var tr=b((Lt,er)=>{"use strict";var Dt=t=>new Promise((i,e)=>{let r=new FileReader;r.onload=()=>{i(r.result)},r.onerror=({target:{error:{code:m}}})=>{e(Error(`File could not be read! Code=${m}`))},r.readAsArrayBuffer(t)}),Tt=t=>w(Lt,null,function*(){let i=t;if(typeof t>"u")return"undefined";if(typeof t=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(t)?i=atob(t.split(",")[1]).split("").map(e=>e.charCodeAt(0)):i=yield(yield fetch(t)).arrayBuffer();else if(typeof HTMLElement<"u"&&t instanceof HTMLElement)t.tagName==="IMG"&&(i=yield Tt(t.src)),t.tagName==="VIDEO"&&(i=yield Tt(t.poster)),t.tagName==="CANVAS"&&(yield new Promise(e=>{t.toBlob(r=>w(Lt,null,function*(){i=yield Dt(r),e()}))}));else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas){let e=yield t.convertToBlob();i=yield Dt(e)}else(t instanceof File||t instanceof Blob)&&(i=yield Dt(t));return new Uint8Array(i)});er.exports=Tt});var rr=b((Po,ir)=>{"use strict";var zr=Wi(),qr=Gi(),Wr=Yi(),$r=Ji(),Gr=Xi(),Hr=tr();ir.exports={defaultOptions:zr,spawnWorker:qr,terminateWorker:Wr,onMessage:$r,send:Gr,loadImage:Hr}});var At=b((ze,sr)=>{"use strict";var Yr=Ni(),H=It(),{log:nr}=dt(),Kr=mt(),ve=kt(),{defaultOptions:Jr,spawnWorker:Zr,terminateWorker:Qr,onMessage:Xr,loadImage:or,send:en}=rr(),ar=0;sr.exports=(...m)=>w(ze,[...m],function*(t="eng",i=ve.LSTM_ONLY,e={},r={}){let f=Kr("Worker",ar),s=Yr(j(j({},Jr),e)),{logger:v,errorHandler:A}=s,R=jt(s,["logger","errorHandler"]),E={},_e=typeof t=="string"?t.split("+"):t,M=i,F=r,fe=[ve.DEFAULT,ve.LSTM_ONLY].includes(i)&&!R.legacyCore,X,z,k=new Promise((n,p)=>{z=n,X=p}),ge=n=>{X(n.message)},V=Zr(R);V.onerror=ge,ar+=1;let P=({id:n,action:p,payload:d})=>new Promise((g,_)=>{nr(`[${f}]: Start ${n}, action=${p}`);let y=`${p}-${n}`;E[y]={resolve:g,reject:_},en(V,{workerId:f,jobId:n,action:p,payload:d})}),De=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),Te=n=>P(H({id:n,action:"load",payload:{options:{lstmOnly:fe,corePath:R.corePath,logging:R.logging}}})),we=(n,p,d)=>P(H({id:d,action:"FS",payload:{method:"writeFile",args:[n,p]}})),ee=(n,p)=>P(H({id:p,action:"FS",payload:{method:"readFile",args:[n,{encoding:"utf8"}]}})),We=(n,p)=>P(H({id:p,action:"FS",payload:{method:"unlink",args:[n]}})),ye=(n,p,d)=>P(H({id:d,action:"FS",payload:{method:n,args:p}})),$e=(n,p)=>P(H({id:p,action:"loadLanguage",payload:{langs:n,options:{langPath:R.langPath,dataPath:R.dataPath,cachePath:R.cachePath,cacheMethod:R.cacheMethod,gzip:R.gzip,lstmOnly:[ve.DEFAULT,ve.LSTM_ONLY].includes(M)&&!R.legacyLang}}})),Me=(n,p,d,g)=>P(H({id:g,action:"initialize",payload:{langs:n,oem:p,config:d}})),vt=(n="eng",p,d,g)=>{if(fe&&[ve.TESSERACT_ONLY,ve.TESSERACT_LSTM_COMBINED].includes(p))throw Error("Legacy model requested but code missing.");let _=p||M;M=_;let y=d||F;F=y;let I=(typeof n=="string"?n.split("+"):n).filter(je=>!_e.includes(je));return _e.push(...I),I.length>0?$e(I,g).then(()=>Me(n,_,y,g)):Me(n,_,y,g)},Le=(n={},p)=>P(H({id:p,action:"setParameters",payload:{params:n}})),Ae=(_,...y)=>w(ze,[_,...y],function*(n,p={},d={text:!0},g){return P(H({id:g,action:"recognize",payload:{image:yield or(n),options:p,output:d}}))}),Fe=(n,p)=>w(ze,null,function*(){if(fe)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return P(H({id:p,action:"detect",payload:{image:yield or(n)}}))}),Ge=()=>w(ze,null,function*(){return V!==null&&(Qr(V),V=null),Promise.resolve()});Xr(V,({workerId:n,jobId:p,status:d,action:g,data:_})=>{let y=`${g}-${p}`;if(d==="resolve")nr(`[${n}]: Complete ${p}`),E[y].resolve({jobId:p,data:_}),delete E[y];else if(d==="reject")if(E[y].reject(_),delete E[y],g==="load"&&X(_),A)A(_);else throw Error(_);else d==="progress"&&v(Y(j({},_),{userJobId:p}))});let c={id:f,worker:V,load:De,writeText:we,readText:ee,removeFile:We,FS:ye,reinitialize:vt,setParameters:Le,recognize:Ae,detect:Fe,terminate:Ge};return Te().then(()=>$e(t)).then(()=>Me(t,i,r)).then(()=>z(c)).catch(()=>{}),k})});var pr=b((qe,lr)=>{"use strict";var cr=At(),tn=(t,i,e)=>w(qe,null,function*(){let r=yield cr(i,1,e);return r.recognize(t).finally(()=>w(qe,null,function*(){yield r.terminate()}))}),rn=(t,i)=>w(qe,null,function*(){let e=yield cr("osd",0,i);return e.detect(t).finally(()=>w(qe,null,function*(){yield e.terminate()}))});lr.exports={recognize:tn,detect:rn}});var dr=b((ko,mr)=>{"use strict";mr.exports={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}});var fr=b((Do,ur)=>{"use strict";ur.exports={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}});var hr=b((To,gr)=>{"use strict";Pi();var nn=Li(),on=At(),an=pr(),sn=dr(),cn=kt(),ln=fr(),{setLogging:pn}=dt();gr.exports=j({languages:sn,OEM:cn,PSM:ln,createScheduler:nn,createWorker:on,setLogging:pn},an)});var ue=class t{constructor(i,e){this.http=i;this.snackBar=e}apiUrl=`${Yt.apiUrl}/receipts`;getAllReceipts(){return this.http.get(this.apiUrl).pipe(Ce(i=>(this.showError("Failed to load receipts"),xe(()=>i))))}getReceipt(i){return this.http.get(`${this.apiUrl}/${i}`).pipe(Ce(e=>(this.showError("Failed to load receipt details"),xe(()=>e))))}uploadReceipt(i){return this.http.post(`${this.apiUrl}/upload`,i).pipe(Ce(e=>(this.snackBar.open("Upload failed","Close",{duration:3e3}),xe(()=>e))))}processReceipt(i){let e=new FormData;return e.append("file",i),this.http.post(`${this.apiUrl}/process`,e).pipe(Ce(r=>(this.showError("OCR processing failed"),xe(()=>r))))}deleteReceipt(i){return this.http.delete(`${this.apiUrl}/${i}`).pipe(Ce(e=>(this.showError("Failed to delete receipt"),xe(()=>e))))}showError(i){this.snackBar.open(i,"Close",{duration:5e3,panelClass:["error-snackbar"]})}static \u0275fac=function(e){return new(e||t)(wt($t),wt(oe))};static \u0275prov=He({token:t,factory:t.\u0275fac,providedIn:"root"})};var yr=t=>["/receipts",t];function Mr(t,i){t&1&&(a(0,"div",9),T(1,"mat-spinner"),a(2,"p"),l(3,"Loading receipts..."),o()())}function xr(t,i){if(t&1){let e=ie();a(0,"div",10)(1,"mat-icon",11),l(2,"error"),o(),a(3,"p"),l(4),o(),a(5,"button",12),L("click",function(){x(e);let m=S();return C(m.loadReceipts())}),a(6,"mat-icon"),l(7,"refresh"),o(),l(8," Retry "),o()()}if(t&2){let e=S();u(4),N(e.error)}}function Cr(t,i){t&1&&(a(0,"div",13)(1,"mat-icon",14),l(2,"receipt"),o(),a(3,"h2"),l(4,"No receipts found"),o(),a(5,"p"),l(6,"Upload your first receipt to get started"),o(),a(7,"button",15)(8,"mat-icon"),l(9,"upload"),o(),l(10," Upload Receipt "),o()())}function br(t,i){if(t&1&&(a(0,"span",18)(1,"mat-icon"),l(2,"attach_money"),o(),l(3),Q(4,"currency"),o()),t&2){let e=S().$implicit;u(3),B(" ",Be(4,1,e.totalAmount)," ")}}function Sr(t,i){if(t&1){let e=ie();a(0,"mat-card",16)(1,"mat-card-header")(2,"mat-card-title"),l(3),o(),a(4,"mat-card-subtitle"),l(5),Q(6,"date"),o()(),a(7,"mat-card-content")(8,"div",17)(9,"span",18)(10,"mat-icon"),l(11,"shopping_basket"),o(),l(12),o(),O(13,br,5,3,"span",19),o()(),a(14,"mat-card-actions",20)(15,"button",21),L("click",function(m){let f=x(e).$implicit,v=S();return C(v.deleteReceipt(f.id,m))}),a(16,"mat-icon"),l(17,"delete"),o()()()()}if(t&2){let e=i.$implicit,r=S();h("routerLink",qt(8,yr,e.id)),u(3),N(e.storeName||"Unknown Store"),u(2),B(" ",Re(6,5,e.purchaseDate,"mediumDate")," "),u(7),B(" ",r.getTotalItems(e)," items "),u(),h("ngIf",e.totalAmount)}}var lt=class t{constructor(i,e){this.receiptService=i;this.snackBar=e}receipts=[];loading=!0;error="";ngOnInit(){this.loadReceipts()}loadReceipts(){this.loading=!0,this.error="",this.receiptService.getAllReceipts().subscribe({next:i=>{this.receipts=i,this.loading=!1},error:i=>{this.loading=!1,this.error="Failed to load receipts",this.snackBar.open(this.error,"Close",{duration:5e3,panelClass:["error-snackbar"]})}})}deleteReceipt(i,e){e.stopPropagation(),confirm("Are you sure you want to delete this receipt?")&&this.receiptService.deleteReceipt(i).subscribe({next:()=>{this.snackBar.open("Receipt deleted","Close",{duration:3e3}),this.loadReceipts()},error:()=>{this.snackBar.open("Failed to delete receipt","Close",{duration:3e3})}})}getTotalItems(i){return i.items?.length||0}static \u0275fac=function(e){return new(e||t)(D(ue),D(oe))};static \u0275cmp=te({type:t,selectors:[["app-receipt-list"]],decls:14,vars:4,consts:[["color","primary"],[1,"spacer"],["mat-raised-button","","routerLink","/receipts/upload"],[1,"container"],["class","loading-spinner",4,"ngIf"],["class","error-message",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"receipt-grid"],["class","receipt-card",3,"routerLink",4,"ngFor","ngForOf"],[1,"loading-spinner"],[1,"error-message"],["color","warn"],["mat-button","",3,"click"],[1,"empty-state"],[1,"empty-icon"],["mat-raised-button","","color","primary","routerLink","/receipts/upload"],[1,"receipt-card",3,"routerLink"],[1,"receipt-meta"],[1,"meta-item"],["class","meta-item",4,"ngIf"],["align","end"],["mat-icon-button","","color","warn","aria-label","Delete receipt",3,"click"]],template:function(e,r){e&1&&(a(0,"mat-toolbar",0)(1,"span"),l(2,"My Receipts"),o(),T(3,"span",1),a(4,"button",2)(5,"mat-icon"),l(6,"add"),o(),l(7," Upload Receipt "),o()(),a(8,"div",3),O(9,Mr,4,0,"div",4)(10,xr,9,1,"div",5)(11,Cr,11,0,"div",6),a(12,"div",7),O(13,Sr,18,10,"mat-card",8),o()()),e&2&&(u(9),h("ngIf",r.loading),u(),h("ngIf",!r.loading&&r.error),u(),h("ngIf",!r.loading&&r.receipts.length===0),u(2),h("ngForOf",r.receipts))},dependencies:[q,Oe,re,Ke,Ye,$,ae,et,ce,pe,le,se,W,ne,Ze,Ue,Ht,G,me,de,Pe,ot,xi],styles:[".container[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto}.spacer[_ngcontent-%COMP%]{flex:1 1 auto}.loading-spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;gap:16px}.error-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;gap:16px;color:#f44336}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;gap:16px;text-align:center}.empty-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#757575}.receipt-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px}.receipt-card[_ngcontent-%COMP%]{cursor:pointer;transition:transform .2s,box-shadow .2s}.receipt-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 4px 8px #0003}.receipt-meta[_ngcontent-%COMP%]{display:flex;gap:16px;margin-top:8px}.meta-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:.9rem;color:#666}@media (max-width: 600px){.container[_ngcontent-%COMP%]{padding:16px}.receipt-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};function Ir(t,i){if(t&1&&(a(0,"div",26)(1,"pre"),l(2),o()()),t&2){let e=S();u(2),N(e.data.ocrResult.rawText)}}function Er(t,i){if(t&1&&(a(0,"div",27),T(1,"img",28),o()),t&2){let e=S();u(),h("src",e.data.image,be)}}function kr(t,i){if(t&1){let e=ie();a(0,"mat-list-item",29)(1,"div",30)(2,"mat-form-field",31)(3,"mat-label"),l(4,"Name"),o(),a(5,"input",14),Z("ngModelChange",function(m){let f=x(e).$implicit;return J(f.name,m)||(f.name=m),C(m)}),o()(),a(6,"mat-form-field",32)(7,"mat-label"),l(8,"Quantity"),o(),a(9,"input",33),Z("ngModelChange",function(m){let f=x(e).$implicit;return J(f.quantity,m)||(f.quantity=m),C(m)}),o()(),a(10,"mat-form-field",34)(11,"mat-label"),l(12,"Unit"),o(),a(13,"mat-select",35),Z("ngModelChange",function(m){let f=x(e).$implicit;return J(f.unit,m)||(f.unit=m),C(m)}),a(14,"mat-option",36),l(15,"Pieces"),o(),a(16,"mat-option",37),l(17,"Kilograms"),o(),a(18,"mat-option",38),l(19,"Grams"),o(),a(20,"mat-option",39),l(21,"Liters"),o(),a(22,"mat-option",40),l(23,"Milliliters"),o(),a(24,"mat-option",41),l(25,"Pack"),o()()(),a(26,"mat-form-field",42)(27,"mat-label"),l(28,"Expiry Date"),o(),a(29,"input",15),Z("ngModelChange",function(m){let f=x(e).$implicit;return J(f.expiryDate,m)||(f.expiryDate=m),C(m)}),o(),T(30,"mat-datepicker-toggle",16)(31,"mat-datepicker",null,1),o(),a(33,"mat-form-field",43)(34,"mat-label"),l(35,"Storage"),o(),a(36,"mat-select",35),Z("ngModelChange",function(m){let f=x(e).$implicit;return J(f.storageLocation,m)||(f.storageLocation=m),C(m)}),a(37,"mat-option",44),l(38,"Fridge"),o(),a(39,"mat-option",45),l(40,"Pantry"),o(),a(41,"mat-option",46),l(42,"Freezer"),o()()(),a(43,"button",47),L("click",function(){let m=x(e).index,f=S();return C(f.removeItem(m))}),a(44,"mat-icon"),l(45,"delete"),o()()()()}if(t&2){let e=i.$implicit,r=Se(32);u(5),K("ngModel",e.name),u(4),K("ngModel",e.quantity),u(4),K("ngModel",e.unit),u(16),h("matDatepicker",r),K("ngModel",e.expiryDate),u(),h("for",r),u(6),K("ngModel",e.storageLocation)}}function Dr(t,i){t&1&&(a(0,"mat-icon"),l(1,"save"),o())}function Tr(t,i){t&1&&(a(0,"mat-icon"),T(1,"mat-spinner",48),o())}var pt=class t{constructor(i,e,r,m){this.dialogRef=i;this.data=e;this.receiptService=r;this.snackBar=m;this.data.ocrResult.purchaseDate=e.ocrResult.purchaseDate?new Date(e.ocrResult.purchaseDate):new Date,this.editedItems=e.ocrResult.items.map(f=>Y(j({},f),{expiryDate:null,storageLocation:f.storageLocation||"dry_pantry"})),this.confidence=e.ocrResult.confidence}editedItems;showRawText=!1;showImage=!1;confidence;isUploading=!1;toggleImage(){this.showImage=!this.showImage}isFormValid(){return typeof this.data.ocrResult.storeName=="string"&&this.data.ocrResult.storeName.trim()!==""&&this.data.ocrResult.purchaseDate&&this.editedItems.every(i=>i.name&&i.quantity&&i.unit&&i.expiryDate&&i.storageLocation)}onSave(){return w(this,null,function*(){if(!this.isFormValid()){this.snackBar.open("Please fill all required fields","Close",{duration:3e3});return}this.isUploading=!0;try{let i={storeName:this.data.ocrResult.storeName,purchaseDate:this.data.ocrResult.purchaseDate.toISOString().split("T")[0],totalAmount:this.data.ocrResult.totalAmount,items:this.editedItems.map(r=>Y(j({},r),{expiryDate:r.expiryDate.toISOString()}))},e=new FormData;if(e.append("receipt",JSON.stringify(i)),this.data.image instanceof File)e.append("file",this.data.image);else if(typeof this.data.image=="string"){let r=yield fetch(this.data.image).then(f=>f.blob()),m=new File([r],"receipt.jpg",{type:"image/jpeg"});e.append("file",m)}yield this.receiptService.uploadReceipt(e).toPromise(),this.snackBar.open("Receipt saved successfully","Close",{duration:3e3}),this.dialogRef.close(!0)}catch(i){this.snackBar.open("Error saving receipt","Close",{duration:3e3}),console.error("Upload error:",i)}finally{this.isUploading=!1}})}addItem(){this.editedItems.push({name:"",quantity:1,unit:"pcs",expiryDate:null,storageLocation:"dry_pantry"})}removeItem(i){this.editedItems.splice(i,1)}onCancel(){this.dialogRef.close()}getConfidenceColor(){return this.confidence>80?"green":this.confidence>60?"orange":"red"}static \u0275fac=function(e){return new(e||t)(D(ui),D(fi),D(ue),D(oe))};static \u0275cmp=te({type:t,selectors:[["app-ocr-preview-dialog"]],decls:62,vars:22,consts:[["purchaseDatePicker",""],["expiryDatePicker",""],[1,"ocr-dialog-container"],["mat-dialog-title",""],[1,"ocr-meta"],[1,"confidence"],["mat-button","",3,"click"],["class","raw-text",4,"ngIf"],[1,"preview-container"],["class","image-preview mat-elevation-z2",4,"ngIf"],[1,"details-preview"],["appearance","outlined"],[1,"form-row"],["appearance","outline",1,"form-field"],["matInput","","required","",3,"ngModelChange","ngModel"],["matInput","","required","",3,"ngModelChange","matDatepicker","ngModel"],["matSuffix","",3,"for"],["matInput","","type","number","required","",3,"ngModelChange","ngModel"],["matPrefix",""],[1,"items-header"],["mat-button","","color","primary",3,"click"],[1,"items-list"],["class","item-row mat-elevation-z1",4,"ngFor","ngForOf"],["align","end"],["mat-raised-button","","color","primary",3,"click","disabled"],[4,"ngIf"],[1,"raw-text"],[1,"image-preview","mat-elevation-z2"],["alt","Receipt preview",1,"receipt-image",3,"src"],[1,"item-row","mat-elevation-z1"],[1,"item-controls"],["appearance","outline",1,"item-name"],["appearance","outline",1,"item-quantity"],["matInput","","type","number","min","1","required","",3,"ngModelChange","ngModel"],["appearance","outline",1,"item-unit"],["required","",3,"ngModelChange","ngModel"],["value","pcs"],["value","kg"],["value","g"],["value","l"],["value","ml"],["value","pack"],["appearance","outline",1,"item-expiry"],["appearance","outline",1,"item-location"],["value","Fridge"],["value","Pantry"],["value","Freezer"],["mat-icon-button","","color","warn","matTooltip","Remove item",3,"click"],["diameter","20"]],template:function(e,r){if(e&1){let m=ie();a(0,"div",2)(1,"h2",3),l(2,"Review Receipt Details"),o(),a(3,"mat-dialog-content")(4,"div",4)(5,"span",5),l(6),Q(7,"number"),o(),a(8,"button",6),L("click",function(){return x(m),C(r.showRawText=!r.showRawText)}),a(9,"mat-icon"),l(10),o(),l(11),o(),a(12,"button",6),L("click",function(){return x(m),C(r.toggleImage())}),a(13,"mat-icon"),l(14),o(),l(15),o()(),O(16,Ir,3,1,"div",7),a(17,"div",8),O(18,Er,2,1,"div",9),a(19,"div",10)(20,"mat-card",11)(21,"mat-card-header")(22,"mat-card-title"),l(23,"Receipt Information"),o(),a(24,"mat-card-subtitle"),l(25,"Verify and edit extracted data"),o()(),a(26,"mat-card-content")(27,"div",12)(28,"mat-form-field",13)(29,"mat-label"),l(30,"Store Name"),o(),a(31,"input",14),Z("ngModelChange",function(v){return x(m),J(r.data.ocrResult.storeName,v)||(r.data.ocrResult.storeName=v),C(v)}),o()(),a(32,"mat-form-field",13)(33,"mat-label"),l(34,"Purchase Date"),o(),a(35,"input",15),Z("ngModelChange",function(v){return x(m),J(r.data.ocrResult.purchaseDate,v)||(r.data.ocrResult.purchaseDate=v),C(v)}),o(),T(36,"mat-datepicker-toggle",16)(37,"mat-datepicker",null,0),o(),a(39,"mat-form-field",13)(40,"mat-label"),l(41,"Total Amount"),o(),a(42,"input",17),Z("ngModelChange",function(v){return x(m),J(r.data.ocrResult.totalAmount,v)||(r.data.ocrResult.totalAmount=v),C(v)}),o(),a(43,"span",18),l(44,"$\xA0"),o()()(),T(45,"mat-divider"),a(46,"div",19)(47,"h3"),l(48,"Items"),o(),a(49,"button",20),L("click",function(){return x(m),C(r.addItem())}),a(50,"mat-icon"),l(51,"add"),o(),l(52," Add Item "),o()(),a(53,"mat-list",21),O(54,kr,46,7,"mat-list-item",22),o()()()()()(),a(55,"mat-dialog-actions",23)(56,"button",6),L("click",function(){return x(m),C(r.onCancel())}),l(57,"Cancel"),o(),a(58,"button",24),L("click",function(){return x(m),C(r.onSave())}),O(59,Dr,2,0,"mat-icon",25)(60,Tr,2,0,"mat-icon",25),l(61),o()()()}if(e&2){let m=Se(38);u(5),Ut("color",r.getConfidenceColor()),u(),B(" OCR Confidence: ",Re(7,19,r.confidence,"1.0-0"),"% "),u(4),N(r.showRawText?"visibility_off":"visibility"),u(),B(" ",r.showRawText?"Hide Raw Text":"Show Raw Text"," "),u(3),N(r.showImage?"visibility_off":"visibility"),u(),B(" ",r.showImage?"Hide Receipt Image":"Show Receipt Image"," "),u(),h("ngIf",r.showRawText),u(2),h("ngIf",r.showImage),u(13),K("ngModel",r.data.ocrResult.storeName),u(4),h("matDatepicker",m),K("ngModel",r.data.ocrResult.purchaseDate),u(),h("for",m),u(6),K("ngModel",r.data.ocrResult.totalAmount),u(12),h("ngForOf",r.editedItems),u(4),h("disabled",r.isUploading||!r.isFormValid()),u(),h("ngIf",!r.isUploading),u(),h("ngIf",r.isUploading),u(),B(" ",r.isUploading?"Saving...":"Save Receipt"," ")}},dependencies:[q,Oe,re,Wt,it,hi,_i,vi,W,ne,Ze,$,ae,ce,pe,le,se,G,me,Qe,Zt,ei,Qt,ii,ti,Xt,Xe,nt,wi,ai,ri,ni,oi,rt,Ie,st,ct,at,di,li,pi,mi,tt,Mi,yi,si,ci,de,Pe],styles:[".ocr-dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;gap:1rem}.preview-container[_ngcontent-%COMP%]{display:flex;gap:1.5rem;height:65vh;flex-direction:column}.image-preview[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;align-items:center;background-color:#f5f5f5;border-radius:8px;padding:1rem;overflow:hidden}.receipt-image[_ngcontent-%COMP%]{max-height:100%;max-width:100%;object-fit:contain;border-radius:4px}.details-preview[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding-right:.5rem}.form-row[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}.form-field[_ngcontent-%COMP%]{flex:1}.items-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin:1rem 0}.items-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.item-row[_ngcontent-%COMP%]{padding:1rem;margin-bottom:1rem;border-radius:8px;background-color:#fff;box-shadow:0 2px 4px #0000001a;transition:all .2s ease;overflow:visible}.item-row[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.item-controls[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:1rem;width:100%;align-items:start;padding-top:1rem}.item-name[_ngcontent-%COMP%]{grid-column:span 2}.item-quantity[_ngcontent-%COMP%], .item-unit[_ngcontent-%COMP%], .item-expiry[_ngcontent-%COMP%], .item-location[_ngcontent-%COMP%]{min-width:0}mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-datepicker-input[_ngcontent-%COMP%]{width:100%}.mat-mdc-select-panel[_ngcontent-%COMP%]{max-height:300px!important}.mat-datepicker-toggle[_ngcontent-%COMP%]{display:flex;align-items:center}.mat-mdc-list-item[_ngcontent-%COMP%]{height:auto!important;--mdc-list-list-item-one-line-container-height: auto !important}.mdc-list-item__content[_ngcontent-%COMP%]{width:100%}.ocr-meta[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem 1rem;background-color:#f5f5f5;border-radius:8px;margin-bottom:1rem}.confidence[_ngcontent-%COMP%]{font-weight:500;font-size:.9rem}.raw-text[_ngcontent-%COMP%]{max-height:200px;overflow:auto;background-color:#fafafa;padding:1rem;border-radius:8px;border:1px solid #e0e0e0;font-family:Roboto Mono,monospace;white-space:pre-wrap;margin-bottom:1rem;font-size:.85rem}.mat-mdc-text-field-wrapper[_ngcontent-%COMP%]{height:auto;min-height:56px;align-items:stretch!important}.mat-mdc-form-field-infix[_ngcontent-%COMP%]{min-height:48px;padding-top:12px!important;padding-bottom:12px!important}@media (max-width: 960px){.preview-container[_ngcontent-%COMP%]{flex-direction:column;height:auto;max-height:70vh}.image-preview[_ngcontent-%COMP%]{max-height:200px}.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}.item-controls[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}.item-name[_ngcontent-%COMP%]{grid-column:span 2}}@media (max-width: 600px){.item-controls[_ngcontent-%COMP%]{grid-template-columns:1fr}.item-name[_ngcontent-%COMP%]{grid-column:span 1}.ocr-dialog-container[_ngcontent-%COMP%]{padding:.5rem}.mat-mdc-form-field[_ngcontent-%COMP%]{font-size:14px}.mat-mdc-form-field-infix[_ngcontent-%COMP%]{min-height:44px;padding-top:10px!important;padding-bottom:10px!important}}"]})};var vr=wr(hr());var ft=class t{progress$=new _t(0);status$=new _t("");constructor(){}recognize(i){return w(this,null,function*(){this.status$.next("Initializing Tesseract..."),this.progress$.next(0);let e=yield(0,vr.createWorker)();e.setParameters({logger:r=>{r.status==="recognizing text"?(this.progress$.next(r.progress),this.status$.next(`Processing: ${Math.round(r.progress*100)}%`)):this.status$.next(r.status)}});try{yield e.load(),yield e.load(),yield e.reinitialize("eng"),this.status$.next("Processing receipt...");let{data:r}=yield e.recognize(i);return{text:r.text,confidence:r.confidence}}finally{yield e.terminate(),this.progress$.next(1),this.status$.next("Done")}})}getProgress(){return this.progress$.asObservable()}getStatus(){return this.status$.asObservable()}static \u0275fac=function(e){return new(e||t)};static \u0275prov=He({token:t,factory:t.\u0275fac,providedIn:"root"})};function dn(t,i){if(t&1&&(a(0,"div",13)(1,"mat-icon",14),l(2,"cloud_upload"),o(),a(3,"p"),l(4,"Click to select a receipt image"),o(),a(5,"p",15),l(6),o()()),t&2){let e=S();u(6),B("Max file size: ",e.maxFileSizeMB,"MB")}}function un(t,i){if(t&1&&(a(0,"div",16),T(1,"img",17),o()),t&2){let e=S();u(),h("src",e.previewImage,be)}}function fn(t,i){if(t&1&&(a(0,"div",18),T(1,"mat-progress-bar",19),a(2,"p"),l(3),o()()),t&2){let e=S();u(),h("value",e.progress*100),u(2),N(e.status)}}function gn(t,i){t&1&&(a(0,"span"),l(1,"Process Receipt"),o())}function hn(t,i){t&1&&(a(0,"span"),l(1,"Processing..."),o())}function vn(t,i){t&1&&T(0,"mat-progress-bar",20)}var gt=class t{constructor(i,e,r){this.ocrService=i;this.router=e;this.dialog=r}selectedFile=null;processing=!1;previewImage=null;maxFileSizeMB=5;progress=0;status="";onFileSelected(i){let e=i.target;if(e.files&&e.files[0]){let r=e.files[0];if(r.size>this.maxFileSizeMB*1024*1024){this.status=`File size exceeds ${this.maxFileSizeMB}MB limit`;return}this.selectedFile=r;let m=new FileReader;m.onload=()=>{this.previewImage=m.result},m.readAsDataURL(r)}}processReceipt(){return w(this,null,function*(){if(this.selectedFile){this.processing=!0,this.status="Starting OCR processing...";try{let i=yield this.ocrService.recognize(this.selectedFile),e=this.parseOcrResult(i.text);this.openOcrPreviewDialog({image:this.previewImage,ocrResult:Y(j({},e),{rawText:i.text,confidence:i.confidence})})}catch(i){this.status="OCR processing failed",console.error("OCR Error:",i)}finally{this.processing=!1}}})}parseOcrResult(i){let e=i.split(`
`).filter(A=>A.trim()),r=i.match(/(Walmart|Target|Costco|Amazon|Whole Foods)/i),m=i.match(/(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4})/),f=i.match(/total.*?(\d+\.\d{2})/i),v=e.filter(A=>A.match(/(\d+\.\d{2})$/)&&A.length<50&&!A.match(/total|subtotal|tax/i)).map(A=>{let R=A.match(/(\d+\.\d{2})$/);return{name:A.replace(R?.[0]||"","").trim(),quantity:1,unit:"pcs",price:R?parseFloat(R[1]):void 0}});return{storeName:r?.[0]||"Unknown Store",purchaseDate:m?.[0]?new Date(m[0]):new Date,totalAmount:f?parseFloat(f[1]):void 0,items:v}}openOcrPreviewDialog(i){this.dialog.open(pt,{width:"90vw",maxWidth:"800px",data:i}).afterClosed().subscribe(r=>{r==="upload"&&this.router.navigate(["/receipts"])})}static \u0275fac=function(e){return new(e||t)(D(ft),D(Je),D(gi))};static \u0275cmp=te({type:t,selectors:[["app-receipt-upload"]],decls:21,vars:10,consts:[["fileInput",""],[1,"upload-container"],[1,"upload-card"],[1,"upload-area",3,"click"],["type","file","accept","image/*",2,"display","none",3,"change"],["class","upload-prompt",4,"ngIf"],["class","file-preview",4,"ngIf"],["class","processing-status",4,"ngIf"],["align","end"],["mat-button","",3,"click","disabled"],["mat-raised-button","","color","primary",3,"click","disabled"],[4,"ngIf"],["mode","indeterminate",4,"ngIf"],[1,"upload-prompt"],[1,"upload-icon"],[1,"file-size-hint"],[1,"file-preview"],["alt","Receipt preview",1,"preview-image",3,"src"],[1,"processing-status"],["mode","determinate",3,"value"],["mode","indeterminate"]],template:function(e,r){if(e&1){let m=ie();a(0,"div",1)(1,"mat-card",2)(2,"mat-card-header")(3,"mat-card-title"),l(4,"Upload Receipt"),o(),a(5,"mat-card-subtitle"),l(6,"Upload an image of your grocery receipt"),o()(),a(7,"mat-card-content")(8,"div",3),L("click",function(){x(m);let v=Se(10);return C(v.click())}),a(9,"input",4,0),L("change",function(v){return x(m),C(r.onFileSelected(v))}),o(),O(11,dn,7,1,"div",5)(12,un,2,1,"div",6),o(),O(13,fn,4,2,"div",7),o(),a(14,"mat-card-actions",8)(15,"button",9),L("click",function(){x(m);let v=Se(10);return C(v.click())}),l(16," Change File "),o(),a(17,"button",10),L("click",function(){return x(m),C(r.processReceipt())}),O(18,gn,2,0,"span",11)(19,hn,2,0,"span",11),o()(),O(20,vn,1,0,"mat-progress-bar",12),o()()}e&2&&(u(8),Vt("has-file",!!r.previewImage),u(3),h("ngIf",!r.previewImage),u(),h("ngIf",r.previewImage),u(),h("ngIf",r.processing),u(2),h("disabled",r.processing),u(2),h("disabled",!r.selectedFile||r.processing),u(),h("ngIf",!r.processing),u(),h("ngIf",r.processing),u(),h("ngIf",r.processing))},dependencies:[q,re,W,ne,$,ae,et,ce,pe,le,se,bi,Ci,G,me],styles:[".upload-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:24px}.upload-card[_ngcontent-%COMP%]{width:100%;max-width:600px}.upload-area[_ngcontent-%COMP%]{border:2px dashed #ccc;border-radius:4px;padding:2rem;text-align:center;cursor:pointer;transition:all .3s ease;margin-bottom:1rem;min-height:200px;display:flex;justify-content:center;align-items:center;flex-direction:column}.upload-area[_ngcontent-%COMP%]:hover{border-color:#3f51b5;background-color:#3f51b50a}.upload-area.has-file[_ngcontent-%COMP%]{border-style:solid;border-color:#4caf50;background-color:#4caf500a}.upload-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#3f51b5}.upload-prompt[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px}.file-size-hint[_ngcontent-%COMP%]{font-size:.8rem;color:#666}.file-preview[_ngcontent-%COMP%]{width:100%;max-height:400px;display:flex;justify-content:center}.preview-image[_ngcontent-%COMP%]{max-width:100%;max-height:400px;object-fit:contain}@media (max-width: 600px){.upload-container[_ngcontent-%COMP%], .upload-card[_ngcontent-%COMP%]{padding:16px}.upload-area[_ngcontent-%COMP%]{padding:1rem;min-height:150px}}.processing-status[_ngcontent-%COMP%]{margin-top:1rem;text-align:center}.processing-status[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:.5rem;font-size:.9rem;color:#666}"]})};function _n(t,i){t&1&&(a(0,"div",5),T(1,"mat-spinner"),a(2,"p"),l(3,"Loading receipt details..."),o()())}function wn(t,i){if(t&1&&(a(0,"div",6)(1,"mat-icon",7),l(2,"error"),o(),a(3,"p"),l(4),o()()),t&2){let e=S();u(4),N(e.error)}}function yn(t,i){if(t&1&&T(0,"img",12),t&2){let e=S(2);h("src",e.receipt.imagePath,be)}}function Mn(t,i){if(t&1&&(a(0,"span",18),l(1),Q(2,"currency"),o()),t&2){let e=S().$implicit,r=S(2);u(),B(" ",Be(2,1,r.getTotalPrice(e))," ")}}function xn(t,i){if(t&1&&(a(0,"mat-list-item",13)(1,"div",14)(2,"span",15),l(3),o(),a(4,"span",16),l(5),o()(),O(6,Mn,3,3,"span",17),o()),t&2){let e=i.$implicit;u(3),N(e.name),u(2),zt("",e.quantity," ",e.unit,""),u(),h("ngIf",e.price)}}function Cn(t,i){if(t&1&&(a(0,"div",19)(1,"span"),l(2,"Total:"),o(),a(3,"span"),l(4),Q(5,"currency"),o()()),t&2){let e=S(2);u(4),N(Be(5,1,e.receipt.totalAmount))}}function bn(t,i){if(t&1&&(a(0,"div",8)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),l(4),o(),a(5,"mat-card-subtitle"),l(6),Q(7,"date"),o()(),O(8,yn,1,1,"img",9),a(9,"mat-card-content")(10,"h3"),l(11,"Items"),o(),a(12,"mat-list"),O(13,xn,7,4,"mat-list-item",10),o(),T(14,"mat-divider"),O(15,Cn,6,3,"div",11),o()()()),t&2){let e=S();u(4),N(e.receipt.storeName||"Unknown Store"),u(2),B(" ",Re(7,5,e.receipt.purchaseDate,"fullDate")," "),u(2),h("ngIf",e.receipt.imagePath),u(5),h("ngForOf",e.receipt.items),u(2),h("ngIf",e.receipt.totalAmount)}}var ht=class t{constructor(i,e,r,m){this.route=i;this.router=e;this.receiptService=r;this.snackBar=m}loading=!0;error="";receipt=null;ngOnInit(){let i=this.route.snapshot.paramMap.get("id");if(!i){this.router.navigate(["/receipts"]);return}this.loadReceipt(i)}loadReceipt(i){this.loading=!0,this.error="",this.receiptService.getReceipt(i).subscribe({next:e=>{this.receipt=e,this.loading=!1},error:e=>{this.loading=!1,this.error="Failed to load receipt details",this.snackBar.open(this.error,"Close",{duration:5e3,panelClass:["error-snackbar"]}),this.router.navigate(["/receipts"])}})}getTotalPrice(i){return i.price?i.price*i.quantity:0}static \u0275fac=function(e){return new(e||t)(D(Gt),D(Je),D(ue),D(oe))};static \u0275cmp=te({type:t,selectors:[["app-receipt-detail"]],decls:8,vars:3,consts:[[1,"receipt-detail-container"],["mat-button","",3,"click"],["class","loading-spinner",4,"ngIf"],["class","error-message",4,"ngIf"],["class","receipt-content",4,"ngIf"],[1,"loading-spinner"],[1,"error-message"],["color","warn"],[1,"receipt-content"],["alt","Receipt image","class","receipt-image",3,"src",4,"ngIf"],["class","item-row",4,"ngFor","ngForOf"],["class","total-amount",4,"ngIf"],["alt","Receipt image",1,"receipt-image",3,"src"],[1,"item-row"],[1,"item-details"],[1,"item-name"],[1,"item-quantity"],["class","item-price",4,"ngIf"],[1,"item-price"],[1,"total-amount"]],template:function(e,r){e&1&&(a(0,"div",0)(1,"button",1),L("click",function(){return r.router.navigate(["/receipts"])}),a(2,"mat-icon"),l(3,"arrow_back"),o(),l(4," Back to Receipts "),o(),O(5,_n,4,0,"div",2)(6,wn,5,1,"div",3)(7,bn,16,8,"div",4),o()),e&2&&(u(5),h("ngIf",r.loading),u(),h("ngIf",r.error),u(),h("ngIf",r.receipt&&!r.loading))},dependencies:[q,Oe,re,Ke,Ye,W,ne,$,ae,ce,pe,le,se,G,me,de,Pe,Ie,st,ct,at,Si],styles:[".receipt-detail-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:24px}.loading-spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;gap:16px}.error-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#f44336;padding:16px;background-color:#f443361a;border-radius:4px;margin:16px 0}.receipt-content[_ngcontent-%COMP%]{margin-top:16px}.receipt-image[_ngcontent-%COMP%]{width:100%;max-height:500px;object-fit:contain;margin:16px 0;border-radius:4px}.item-row[_ngcontent-%COMP%]{height:auto!important;padding:8px 0}.item-details[_ngcontent-%COMP%]{flex:1;display:flex;gap:16px}.item-name[_ngcontent-%COMP%]{flex:2}.item-quantity[_ngcontent-%COMP%]{flex:1;color:#666}.item-price[_ngcontent-%COMP%]{font-weight:500}.total-amount[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:16px;font-size:1.2rem;font-weight:500}@media (max-width: 600px){.receipt-detail-container[_ngcontent-%COMP%]{padding:16px}.item-details[_ngcontent-%COMP%]{flex-direction:column;gap:4px}}"]})};var Sn=[{path:"",component:lt,canActivate:[Jt]},{path:"upload",component:gt},{path:":id",component:ht}],_r=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=Bt({type:t});static \u0275inj=Nt({imports:[q,Ue.forChild(Sn),W,$,de,Kt,G,ot,Ie,nt,rt,Qe,Xe,it,tt,Ue]})};export{_r as ReceiptsModule};
